# bcode-algorithm-test

## 최초 제안내용

  * 가정

    1. 손으로 하는거니까 칠할때 빽빽히 1픽셀도 안남기고 칠하는 경우는 없을 것
    2. 최소 해당 칸의 절반 이상은 칠해야 인식이 되고라고는 알려줘야 함

  * 기존 알고리즘

    1. 전체 영역을 9칸(3x3)으로 등분
    2. 전체 9칸의 픽셀 값 평균과 각 칸의 픽셀 값 평균을 비교함
    3. 각 칸의 평균이 전체 평균보다 낮으면 칠해짐(1) or 높으면 안칠해짐(0) 으로 판단

  * 개선 알고리즘

    1. 전체 영역을 9칸(3x3)으로 등분
    2. 각 칸에서 내접원을 그린 후 원안에 있는 픽셀만 고려
    3. 각 칸에서 모든 픽셀을 대상으로 k=2인 k-means 알고리즘 수행(https://ko.wikipedia.org/wiki/K-%ED%8F%89%EA%B7%A0_%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98)
    4. 3에서 얻은 각 영역의 평균의 비율(높은값/낮은값)을 계산(A)함
    5. 각 영역에서 클러스터링된 샘플들의 숫자의 비율을 계산(B)함
    6. B가 35~65이면서 A가 3이상인 영역을 칠해짐(1) or 그렇지 않으면 안칠해짐(0)으로 판단
    7. 6의 판단 기준 숫자들(35,65,3)은 변경 될 수 있음

## 20180115

  * 기본 정보

    1. 갤럭시 S3 사진 해상도 최대 : 3264x2448
    2. A4 용지 캡쳐 해상도 : 1070x1518
    3. 갤럭시 S3 에서 찍은 사진의 A4 용지의 최대 영역 : 3264x2300
    4. A4 용지에서 비코드 해상도 : 154x154
    5. 갤럭시 S3 에서의 해상도 : 330x330
    6. 최종 리사리즈 해상도 : 150x150

  * 현재 엔진 성능

    1. 기본 성능 : 8.33%
    2. 가장자리 크롭 : 37.96%

  * 요구 사항

    1. 데이터셋을 더 정교하게 만들어야 함
    2. 실제 용지에 색칠해서 데이터셋을 새로 만들어 보자

  * 사용 방법

    1. git clone https://github.com/kdh812/bcode-algorithm-test
    2. cd bcode-algorithm-test
    3. npm install
    4. node index.js

## 20180220

  * 개선 내용

    1. 크롭된 이미지도 출력하게 변경
    2. 최신 데이터셋 사용
    3. 이미지 크롭 알고리즘을 150기준의 픽셀로 변경
    4. 기본 성능: 54%
    5. 가장자리 크롭: 14일때 74%
      * 0: 54%
      * 1: 55%
      * 2: 58%
      * 3: 62%
      * 4: 64%
      * 5: 67%
      * 6: 68%
      * 7: 68%
      * 8: 69%
      * 9: 71%
      * 10: 72%
      * 11: 73%
      * 12: 73%
      * 13: 73%
      * 14: 74%
      * 15: 73%
      * 16: 72%
      * 17: 72%
      * 18: 72%
      * 19: 70%
      * 20: 69%
    6. 내접원 알고리즘 적용 - 하나 박스 크기가 50: 19일때 79%
      * 25: 77%
      * 24: 78%
      * 23: 78%
      * 22: 78%
      * 21: 78%
      * 20: 79%
      * 19: 79%
      * 18: 79%
      * 17: 78%
      * 16: 77%
      * 15: 77%
    7. 몇개가 틀린지 카운트하는 로직 추가